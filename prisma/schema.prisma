generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Freelancer {
  id         String      @id @default(cuid())

  

  name       String?
  username   String?   @unique
  email      String  @unique
  password   String
  mobile     BigInt?
  city       String?
  country    String?
  pincode    String?
  profession String?

  clients    Client[]  @relation("FreelancerClients") 

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Client {
  id           String        @id @default(cuid())

  name         String
  modeOfPay    String
  status        String

  deliveries   Delivery[] @relation("ClientDeliveries")

  freelancerId String
  reelancer   Freelancer   @relation("FreelancerClients", fields: [freelancerId], references: [id])

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  phone        String?      // Optional phone field
  email        String?      // Optional email field
}

model Delivery {
  id         String      @id @default(cuid())


  name       String
  desc       String
  cost       Float
  PaymentStatus  String
  withdrawStatus String   @default("no")

  files         File[]    @relation("DeliveryFiles")  // Changed to DeliveriesFiles

  clientId      String    // Changed from projectId to clientId
  client        Client    @relation("ClientDeliveries", fields: [clientId], references: [id])

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model File {
  id         String      @id @default(cuid())


  name       String
  url        String

  deliveryId  String    
  delivery   Delivery @relation("DeliveryFiles", fields: [deliveryId], references: [id])  // Changed relation name

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model PasswordReset {
  id              String   @id @default(cuid())
  userId          String      // Foreign key to Freelancer
  token           String   // Reset token
  tokenExpiration DateTime // Token expiration time
  createdAt       DateTime @default(now()) // When the reset request was created

  @@unique([token])  // Ensure token is unique
}


model OtpVerification {
  email     String   @id
  otp       String
  expiresAt DateTime
  createdAt DateTime @default(now())
}


model Blog {
  id          String    @id @default(cuid())
  title       String
  bannerImage String?
  content     String    @db.Text
  published   Boolean   @default(false)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  publishedAt DateTime?
  refLinks    RefLink[]
  tocItems    TocItem[]
}

model RefLink {
  id      String @id @default(cuid())
  title   String
  url     String
  blog    Blog   @relation(fields: [blogId], references: [id], onDelete: Cascade)
  blogId  String
}

model TocItem {
  id      String @id @default(cuid())
  level   Int
  content String
  slug    String
  blog    Blog   @relation(fields: [blogId], references: [id], onDelete: Cascade)
  blogId  String
}